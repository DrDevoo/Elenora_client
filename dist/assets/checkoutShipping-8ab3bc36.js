import{_ as V,r as z,o as i,c as a,b as s,a as _,w as U,t as c,d as r,F as g,f as y,n as p,x as h,z as m,g as I,h as v,L as k,p as S,m as T,y as j}from"./index-c603d831.js";const l=n=>(S("data-v-ff554390"),n=n(),T(),n),w={class:"datas_w"},C={class:"logo_w"},q=l(()=>s("img",{class:"logo",src:j,alt:"ELENORA"},null,-1)),E={class:"cart_w"},L={class:"text"},R=l(()=>s("p",null,"Tekintsd meg a kosarad tartalmát",-1)),A={class:"price"},M={key:0},F={key:0,class:"cart"},N={class:"list"},O={class:"cart_item_imgtext"},$={class:"cart_item_img"},P=["src"],B={class:"cart_item_desc"},H={key:0,class:"result"},J=["src"],D={key:1},K={key:2,class:"quantity"},G={class:"cart_item_del"},Q={class:"prices"},W=l(()=>s("p",null,"Összeg",-1)),X=I('<div class="order_status" data-v-ff554390><div class="sec" data-v-ff554390><div class="circle" data-v-ff554390><p data-v-ff554390>1</p></div><div class="title" data-v-ff554390><p data-v-ff554390>Adatok</p></div></div><div class="hr" data-v-ff554390></div><div class="sec" data-v-ff554390><div class="circle active" data-v-ff554390><p class="active" data-v-ff554390>2</p></div><div class="title" data-v-ff554390><p data-v-ff554390>Szállítás - Fizetés</p></div></div><div class="hr" data-v-ff554390></div><div class="sec" data-v-ff554390><div class="circle" data-v-ff554390><p data-v-ff554390>3</p></div><div class="title" data-v-ff554390><p data-v-ff554390>Összegzés</p></div></div></div>',1),Y={class:"osszesites_w"},Z={class:"oszesites_b"},x={class:"left"},ss=l(()=>s("p",{class:"t"},"Kapcsolattartás",-1)),es={class:"c"},ts={class:"right"},os={class:"oszesites_b"},is={class:"left"},as=l(()=>s("p",{class:"t"},"Szállítási cím",-1)),ns={class:"c"},ls={class:"right"},rs=l(()=>s("h3",null,"Ajándékkártya vagy kupon kódja",-1)),ds={class:"cupon_b"},us={key:3},ps={key:4,style:{"background-color":"green"}},cs={key:0},hs={key:1,style:{color:"green"}},vs=l(()=>s("h3",null,"Számlázási cím",-1)),_s={class:"szamla_b"},ms=l(()=>s("label",{for:"same"},"Egyezik a szállítási címmel",-1)),fs=l(()=>s("br",null,null,-1)),zs=l(()=>s("br",null,null,-1)),gs=l(()=>s("label",{for:"other"},"Másik számlázási címet adok meg",-1)),ys={key:0,class:"otherszamlazasi"},ks={class:"inputflex"},bs={class:"inputflex"},Vs=l(()=>s("h3",null,"Szállítás és fizetés",-1)),Us=l(()=>s("h5",{class:"mini"}," Ha a rendelés összege meghaladja a 15.000 Ft-ot a szállítás ingyenes! ",-1)),Is={class:"options_box"},Ss={class:"flex_option"},Ts={class:"flex_option"},js=l(()=>s("label",{for:"id1"},"Házhozszállítás - Online fizetés",-1)),ws=l(()=>s("div",null,[s("h6",null,"1290 Ft")],-1)),Cs={class:"flex_option"},qs={class:"flex_option"},Es=l(()=>s("label",{for:"id2"},"Házhozszállítás - Utánvétes fizetés",-1)),Ls=l(()=>s("div",null,[s("h6",null,"2080 Ft")],-1)),Rs=l(()=>s("br",null,null,-1)),As={key:1,class:"btntovabb off"},Ms={key:2,class:"btntovabb"},Fs=l(()=>s("br",null,null,-1)),Ns=l(()=>s("br",null,null,-1)),Os={data(){return{showCart:!1,imgurl:"/prodimgs/",orderid:this.$route.query.order,loading:!1,order:[],epty:[],loadingcoupon:!1,cuponcode:"",cuponsresponse:[],cuponactive:!1}},async mounted(){await v.get({}.VITE_API_URL+"/orders/getbyid/"+this.orderid).then(n=>this.order=n.data),this.order.usedcupon!=""&&(await v.get({}.VITE_API_URL+"/cupons/check/"+this.order.usedcupon).then(n=>this.cuponsresponse=n.data),this.cuponcode=this.order.usedcupon,this.cuponactive=!0,this.cart.forEach((n,e)=>{n.name!="Szállítási díj"?(console.log(n),this.cart[e].sale=this.cuponsresponse.cupon_value,console.log("fut")):console.log("elutasitva")}))},methods:{next(){if(this.loading=!0,this.order.cart.find(u=>u.name=="Szállítási díj")){var e=this.order.cart.findIndex(u=>u.name=="Szállítási díj");this.order.cart.splice(e)}if(this.order.cart.find(u=>u.name=="Utánvét díj")){var f=this.order.cart.findIndex(u=>u.name=="Utánvét díj");this.order.cart.splice(f)}this.order.shipping=="delivery-cash"?(this.order.cart.reduce((t,d)=>t+Math.round(d.price-d.price/100*d.sale)*d.quantity,0)>14999?(this.order.cart.push({id:1,name:"Szállítási díj",price:0,quantity:1,sale:0,img:null,visitno:!0}),this.order.cart.push({id:2,name:"Utánvét díj",price:790,quantity:1,sale:0,img:null,visitno:!0})):(this.order.cart.push({id:1,name:"Szállítási díj",price:1290,quantity:1,sale:0,img:null,visitno:!0}),this.order.cart.push({id:2,name:"Utánvét díj",price:790,quantity:1,sale:0,img:null,visitno:!0})),v.post({}.VITE_API_URL+"/orders/updatecart/"+this.orderid,JSON.stringify(this.order.cart),{headers:{"Content-Type":"application/json"}})):(this.order.cart.reduce((t,d)=>t+Math.round(d.price-d.price/100*d.sale)*d.quantity,0)>14999?this.order.cart.push({id:1,name:"Szállítási díj",price:0,quantity:1,sale:0,img:null,visitno:!0}):this.order.cart.push({id:1,name:"Szállítási díj",price:1290,quantity:1,sale:0,img:null,visitno:!0}),v.post({}.VITE_API_URL+"/orders/updatecart/"+this.orderid,JSON.stringify(this.order.cart),{headers:{"Content-Type":"application/json"}})),v.post({}.VITE_API_URL+"/orders/saveshipping/"+this.orderid,JSON.stringify(this.order),{headers:{"Content-Type":"application/json"}}).then(u=>this.$router.push({path:"/shop/checkout/summary",query:{order:this.orderid}})).catch(u=>{console.error("There was an error!",u)})},backto(n){console.log("clicked"),n=="shipping"?this.$router.push({path:"/shop/checkout/shipping",query:{order:this.orderid}}):n=="customer"?this.$router.push({path:"/shop/checkout",query:{order:this.orderid}}):n=="paying"?this.$router.push({path:"/shop/checkout/shipping",query:{order:this.orderid}}):console.log("err")},async check(){this.loadingcoupon=!0,await v.get({}.VITE_API_URL+"/cupons/check/"+this.cuponcode).then(n=>this.cuponsresponse=n.data),this.cuponsresponse._id?(console.log("Kupon aktivalasa"),this.order.cart.forEach((n,e)=>{n.name!="Szállítási díj"?(console.log(n),this.order.cart[e].sale=this.cuponsresponse.cupon_value):console.log("elutasitva")}),v.post({}.VITE_API_URL+"/orders/updatecart/"+this.orderid,JSON.stringify(this.order.cart),{headers:{"Content-Type":"application/json"}}),await v.get({}.VITE_API_URL+"/orders/savecupon/"+this.orderid+"/"+this.cuponsresponse.cupon_name),this.cuponactive=!0):console.log("Hibas kupon!"),this.loadingcoupon=!1}}},$s=Object.assign(Os,{__name:"checkoutShipping",setup(n){return(e,o)=>{const f=z("RouterLink"),u=z("ion-icon");return i(),a("main",null,[s("section",w,[s("div",C,[_(f,{to:"/"},{default:U(()=>[q]),_:1})]),s("div",E,[s("div",{class:"header",onClick:o[0]||(o[0]=t=>e.showCart=!e.showCart)},[s("div",L,[_(u,{class:"cart_icon",name:"cart-outline"}),R,_(u,{name:"chevron-down-outline"})]),s("div",A,[s("b",null,[e.order.cart?(i(),a("p",M,c(e.order.cart.reduce((t,d)=>t+Math.round(d.price-d.price/100*d.sale)*d.quantity,0))+" Ft ",1)):r("",!0)])])]),e.showCart?(i(),a("div",F,[s("div",N,[(i(!0),a(g,null,y(e.order.cart,(t,d)=>(i(),a("div",{class:"cart_item",key:d},[s("div",O,[s("div",$,[t.img!=null?(i(),a("img",{key:0,src:e.imgurl+t.img},null,8,P)):r("",!0)]),s("div",B,[s("p",null,c(t.name),1),t.custom==!0?(i(),a("div",H,[(i(!0),a(g,null,y(t.pearls,b=>(i(),a("div",null,[s("img",{src:"https://elenora.hu:444/getimage/"+b+".webp"},null,8,J)]))),256))])):r("",!0),t.visitno?r("",!0):(i(),a("p",D,"Méret: "+c(t.size),1)),t.visitno?r("",!0):(i(),a("p",K,c(t.quantity),1))])]),s("div",G,[s("h5",null,c(Math.round(t.price-t.price/100*t.sale))+" Ft ",1)])]))),128))]),s("div",Q,[s("div",null,[W,s("b",null,[s("p",null,c(e.total)+" Ft",1)])])])])):r("",!0)]),X,s("div",Y,[s("div",Z,[s("div",x,[ss,s("p",es,c(e.order.u_email),1)]),s("div",ts,[s("p",{class:"ch",onClick:o[1]||(o[1]=t=>e.backto("customer"))},"Módosítás")])]),s("div",os,[s("div",is,[as,s("p",ns,c(e.order.u_postnumber)+" "+c(e.order.u_city)+", "+c(e.order.u_addresse)+", "+c(e.order.u_legio),1)]),s("div",ls,[s("p",{class:"ch",onClick:o[2]||(o[2]=t=>e.backto("customer"))},"Módosítás")])])]),s("div",null,[rs,s("div",ds,[s("div",null,[e.cuponactive?r("",!0):p((i(),a("input",{key:0,type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>e.cuponcode=t),placeholder:"Válts be kuponod"},null,512)),[[h,e.cuponcode]]),e.cuponactive?p((i(),a("input",{key:1,type:"text","onUpdate:modelValue":o[4]||(o[4]=t=>e.cuponcode=t),placeholder:"Válts be kuponod",disabled:""},null,512)),[[h,e.cuponcode]]):r("",!0),!e.loadingcoupon&&!e.cuponactive?(i(),a("button",{key:2,onClick:o[5]||(o[5]=t=>e.check())}," Beváltom ")):r("",!0),e.loadingcoupon?(i(),a("button",us,[_(k)])):r("",!0),e.cuponactive?(i(),a("button",ps," ✓ ")):r("",!0)]),e.cuponsresponse=="Érvénytelen kupon!"?(i(),a("p",cs,"Érvénytelen kód!")):r("",!0),e.cuponsresponse._id?(i(),a("p",hs,c(e.cuponsresponse.cupon_value)+"%-os kupon beváltva! ",1)):r("",!0)]),vs,s("div",_s,[p(s("input",{type:"radio",name:"szamla",value:"same",id:"same","onUpdate:modelValue":o[6]||(o[6]=t=>e.order.szamlazasimod=t)},null,512),[[m,e.order.szamlazasimod]]),ms,fs,zs,p(s("input",{type:"radio",name:"szamla",value:"other",id:"other","onUpdate:modelValue":o[7]||(o[7]=t=>e.order.szamlazasimod=t)},null,512),[[m,e.order.szamlazasimod]]),gs,e.order.szamlazasimod=="other"?(i(),a("div",ys,[p(s("input",{type:"text","onUpdate:modelValue":o[8]||(o[8]=t=>e.order.szamlazasOrszag=t)},null,512),[[h,e.order.szamlazasOrszag]]),s("div",ks,[p(s("input",{type:"text","onUpdate:modelValue":o[9]||(o[9]=t=>e.order.szamlazasVezeteknev=t),placeholder:"Vezetéknév"},null,512),[[h,e.order.szamlazasVezeteknev]]),p(s("input",{type:"text","onUpdate:modelValue":o[10]||(o[10]=t=>e.order.szamlazasUtonev=t),placeholder:"Utónév"},null,512),[[h,e.order.szamlazasUtonev]])]),s("div",bs,[p(s("input",{type:"text","onUpdate:modelValue":o[11]||(o[11]=t=>e.order.szamlazasIranyitoszam=t),placeholder:"Irányítószám"},null,512),[[h,e.order.szamlazasIranyitoszam]]),p(s("input",{type:"text","onUpdate:modelValue":o[12]||(o[12]=t=>e.order.szamlazasTelepules=t),placeholder:"Település"},null,512),[[h,e.order.szamlazasTelepules]])]),p(s("input",{type:"text","onUpdate:modelValue":o[13]||(o[13]=t=>e.order.szamlazasCim=t),placeholder:"Cím"},null,512),[[h,e.order.szamlazasCim]]),p(s("input",{type:"tel","onUpdate:modelValue":o[14]||(o[14]=t=>e.order.szamlazasTel=t),placeholder:"Telefonszám"},null,512),[[h,e.order.szamlazasTel]])])):r("",!0)]),Vs,Us,s("div",Is,[s("div",Ss,[s("div",Ts,[p(s("input",{type:"radio",name:"shipping",id:"id1",value:"delivery-card","onUpdate:modelValue":o[15]||(o[15]=t=>e.order.shipping=t),class:"radio"},null,512),[[m,e.order.shipping]]),js]),ws]),s("div",Cs,[s("div",qs,[p(s("input",{type:"radio",name:"shipping",id:"id2",value:"delivery-cash","onUpdate:modelValue":o[16]||(o[16]=t=>e.order.shipping=t),class:"radio"},null,512),[[m,e.order.shipping]]),Es]),Ls])]),Rs,!e.loading&&e.order.shipping!=""?(i(),a("button",{key:0,class:"btntovabb",onClick:o[17]||(o[17]=(...t)=>e.next&&e.next(...t))}," Összegzés ")):r("",!0),!e.loading&&e.order.shipping==""?(i(),a("button",As," Összegzés ")):r("",!0),e.loading?(i(),a("button",Ms,[_(k)])):r("",!0)])]),Fs,Ns])}}}),Bs=V($s,[["__scopeId","data-v-ff554390"]]);export{Bs as default};
